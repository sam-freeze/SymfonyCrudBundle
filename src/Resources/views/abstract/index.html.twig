{% extends "#{name}.html.twig" %}

{% block name %}{{ "admin.hero"|trans({}, name) }}{% endblock %}

{% block breadcrumb %}
    <li><a class="is-active">{{ "admin.hero"|trans({}, name) }}</a></li>
{% endblock %}

{% block body %}
    {{ form_start(form) }}

    <table class="table is-striped" width="100%">
        <thead>
            <tr>
                {% for column in columns %}
                    <th {% if loop.index > 2 %} class="is-hidden-mobile" {% endif %}>
                        
                        {% set sortName = column.attributes|join('_') %}

                        {% if sort[sortName] is not defined %}
                            <a class="has-text-dark" href="{{ path("#{route}sort_field", { 'field': sortName, 'order' : 'asc' }) }}">
                                <span class="icon">
                                    <i class="fas fa-sort"></i>
                                </span>
                                {{ "column.#{column.name}"|trans({}, name) }}
                            </a>
                        {% elseif sort[sortName] == 'asc' %}
                            <a class="has-text-dark" href="{{ path("#{route}sort_field", { 'field': sortName, 'order' : 'desc' }) }}">
                                <span class="icon">
                                    <i class="fas fa-sort-alpha-up"></i>
                                </span>
                                {{ "column.#{column.name}"|trans({}, name) }}
                            </a>
                        {% elseif sort[sortName] == 'desc' %}
                            <a class="has-text-dark" href="{{ path("#{route}reset_field_sorting", { 'field': sortName }) }}">
                                <span class="icon">
                                    <i class="fas fa-sort-alpha-down-alt"></i>
                                </span>
                                {{ "column.#{column.name}"|trans({}, name) }}
                            </a>
                        {% else %}
                            <a class="has-text-dark" href="{{ path("#{route}sort_field", { 'field': sortName, 'order' : 'asc' }) }}">
                                <span class="icon">
                                    <i class="fas fa-sort"></i>
                                </span>
                                {{ "column.#{column.name}"|trans({}, name) }}
                            </a>
                        {% endif %}
                    </th>
                {% endfor %}
                <th>
                    <div class="buttons has-addons is-right">
                        <a class="button" href="{{ path("#{route}reset_sorting") }}">
                            <span class="icon">
                                <i class="fas fa-eraser"></i>
                            </span>
                        </a>
                        {% block head_btn %}
                        {% endblock %}
                    </div>
                </th>
            </tr>
            <tr>
                {% for column in columns %}
                    <th {% if loop.index > 2 %} class="is-hidden-mobile" {% endif %}>
                        {% set searchName = column.attributes|join('_') %}
                        {% set operatorName = column.attributes|join('_') ~ '_operator' %}
                        <div class="field has-addons">
                            <div class="control">
                                {% if form[searchName] is defined %}
                                    {{ form_widget(form[searchName]) }}
                                {% endif %}
                            </div>
                            <div class="control">
                                {% if form[operatorName] is defined %}
                                    {{ form_widget(form[operatorName]) }}
                                {% endif %}
                            </div>
                        </div>
                    </th>
                {% endfor %}
                <th>
                    <div class="buttons has-addons is-right">
                        <a class="button" href="{{ path("#{route}filter_reset") }}">
                            <span class="icon is-small">
                                <i class="fas fa-eraser"></i>
                            </span>
                        </a>
                        <button type="submit" class="button">
                            <span class="icon is-small">
                                <i class="fas fa-search"></i>
                            </span>
                        </button>
                    </div>
                </th>
            </tr>
        </thead>
        <tfoot>
            <tr>
                {% for column in columns %}
                    <th {% if loop.index > 2 %} class="is-hidden-mobile" {% endif %}>
                        
                        {% set sortName = column.attributes|join('_') %}

                        {% if sort[sortName] is not defined %}
                            <a class="has-text-dark" href="{{ path("#{route}sort_field", { 'field': sortName, 'order' : 'asc' }) }}">
                                <span class="icon">
                                    <i class="fas fa-sort"></i>
                                </span>
                                {{ "column.#{column.name}"|trans({}, name) }}
                            </a>
                        {% elseif sort[sortName] == 'asc' %}
                            <a class="has-text-dark" href="{{ path("#{route}sort_field", { 'field': sortName, 'order' : 'desc' }) }}">
                                <span class="icon">
                                    <i class="fas fa-sort-alpha-up"></i>
                                </span>
                                {{ "column.#{column.name}"|trans({}, name) }}
                            </a>
                        {% elseif sort[sortName] == 'desc' %}
                            <a class="has-text-dark" href="{{ path("#{route}reset_field_sorting", { 'field': sortName }) }}">
                                <span class="icon">
                                    <i class="fas fa-sort-alpha-down-alt"></i>
                                </span>
                                {{ "column.#{column.name}"|trans({}, name) }}
                            </a>
                        {% else %}
                            <a class="has-text-dark" href="{{ path("#{route}sort_field", { 'field': sortName, 'order' : 'asc' }) }}">
                                <span class="icon">
                                    <i class="fas fa-sort"></i>
                                </span>
                                {{ "column.#{column.name}"|trans({}, name) }}
                            </a>
                        {% endif %}
                    </th>
                {% endfor %}
                <th class="has-text-right">
                    <div class="select is-fullwidth">
                        <select onchange="this.options[this.selectedIndex].value && (window.location = this.options[this.selectedIndex].value);">
                            {% for i in range(5, 50, 5) %}
                                <option value="{{ path("#{route}paginate", {'field': 'limit', 'value': i}) }}" {{ i == pagination.limit ? 'selected' : null }}>{{ i }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </th>
            </tr>
        </tfoot>
        <tbody>
            {% if items|length > 0 %}
                {% for item in items %}
                    <tr>
                        {% for column in columns %}
                            <td {% if loop.index > 2 %} class="is-hidden-mobile" {% endif %}>
                                {% include "#{name}/_value.html.twig" with { 'value': item, 'column': column } %}
                            </td>
                        {% endfor %}
                        <td>
                            <div class="buttons has-addons is-right">
                                {% block item_btn %}
                                {% endblock %}
                            </div>
                        </td>
                    </tr>
                {% endfor %}
            {% else %}
                <tr>
                    <td colspan="{{ columns|length + 1 }}" class="has-text-centered has-text-primary">
                        {{ "admin.noresult"|trans({}, name) }}
                    </td>
                </tr>
            {% endif %}
        </tbody>
    </table>

    <div class="columns">
        <div class="column is-12">
            {% include "#{name}/_pagination.html.twig" with { 'pagination': pagination, 'count': items.count, 'route': route } only %}
        </div>
    </div>


    {{ form_end(form) }}
{% endblock %}
